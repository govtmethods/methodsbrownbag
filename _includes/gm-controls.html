<div class="gm-controls" role="navigation" aria-label="Site controls">
  <!-- View PDF -->
  <a class="gm-icon-btn" href="Methods-Brown-Bag.pdf" target="_blank" rel="noopener" aria-label="View PDF" title="View PDF">
    <svg class="gm-icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
      <path d="M7 3.5h7l3 3V20a1.5 1.5 0 0 1-1.5 1.5H7A1.5 1.5 0 0 1 5.5 20V5A1.5 1.5 0 0 1 7 3.5Z"
            stroke="currentColor" stroke-width="1.6" />
      <path d="M14 3.5V7h3.5" stroke="currentColor" stroke-width="1.6" />
      <path d="M8 14.2c1.1-1.3 2.5-2 4-2s2.9.7 4 2c-1.1 1.3-2.5 2-4 2s-2.9-.7-4-2Z"
            stroke="currentColor" stroke-width="1.6" />
      <path d="M12 14.2h0" stroke="currentColor" stroke-width="3.2" stroke-linecap="round" />
    </svg>
  </a>

  <!-- Theme toggle -->
  <button class="gm-icon-btn" type="button" aria-label="Toggle theme" title="Toggle theme"
          onclick="window.__gmToggleTheme && window.__gmToggleTheme()">
    <svg class="gm-icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
      <path d="M12 3v2.2M12 18.8V21M4.2 12H3M21 12h-1.2M6.1 6.1 4.6 4.6M19.4 19.4l-1.5-1.5M17.9 6.1l1.5-1.5M4.6 19.4l1.5-1.5"
        stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
      <path d="M12 7.2a4.8 4.8 0 1 0 0 9.6a4.8 4.8 0 0 0 0-9.6Z"
        stroke="currentColor" stroke-width="1.6"/>
    </svg>
  </button>
</div>

<script>
(function () {
  const controls = document.querySelector(".gm-controls");
  if (!controls) return;

  function mountIntoSidebar() {
    const sidebar = document.getElementById("quarto-sidebar");
    if (!sidebar) return false;

    // Where the title usually lives in Quarto book sidebar
    const titleBlock =
      sidebar.querySelector(".sidebar-title") ||
      sidebar.querySelector(".sidebar-header") ||
      sidebar.querySelector(".sidebar-search") ||
      sidebar;

    // Move controls directly below the title block
    titleBlock.insertAdjacentElement("afterend", controls);
    controls.setAttribute("data-mounted", "true");
    return true;
  }

  // Try immediately (covers most cases)
  if (mountIntoSidebar()) return;

  // Otherwise wait until Quarto finishes building sidebar
  const obs = new MutationObserver(() => {
    if (mountIntoSidebar()) obs.disconnect();
  });

  obs.observe(document.documentElement, { childList: true, subtree: true });

  // Safety: stop observing after 5 seconds
  setTimeout(() => obs.disconnect(), 5000);
})();
</script>